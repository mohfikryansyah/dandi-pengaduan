import{K as B,r as h,j as a,S as n,a as g}from"./app-DKM7dt8d.js";import{A as u,a as p,b as x,c as j,d as k,e as f,f as N,g as y,h as A}from"./alert-dialog-DE7SgoFa.js";import{B as T}from"./badge-CykJfGaV.js";import{B as e}from"./button-Ch5T_YaV.js";import{D as E,a as _,b as K,c as M}from"./dialog-CcRMeUsX.js";import{h as v}from"./helpers-CmNvA0sT.js";import{c as R}from"./utils-D17iiBiz.js";import{statusColorMap as z}from"./show-pengaduan-z749_UT3.js";import{A as o}from"./arrow-up-down-BJLP-FvM.js";import{E as I}from"./eye-D6iR31wJ.js";import{T as F,a as Y}from"./triangle-alert-smepxhca.js";import{C as H}from"./check-C2k6Q05I.js";import{X as O}from"./x-DA2yMRmC.js";import{f as P,i as J}from"./id-CUEIbMhn.js";import"./index-CBy6iI--.js";import"./index-blviR4P5.js";import"./index-Vrro_ThI.js";import"./Combination-ao4a7iry.js";import"./tslib.es6-BUas5LQb.js";import"./avatar-DRnMHcoe.js";import"./index-ZFSzPzMq.js";import"./index-k0HzQP1F.js";import"./delete-dialog-DB-IckJe.js";import"./card-BcxlMsuI.js";import"./app-layout-D1n9UuIy.js";import"./use-mobile-DQiCraAI.js";import"./index-wGUD2AQ0.js";import"./index-xdR8EGyJ.js";import"./floating-ui.react-dom-BMUpqp2O.js";import"./index-CRVKt2cw.js";import"./createLucideIcon-BecT5Nup.js";import"./app-logo-icon-QQfq_JEU.js";import"./chevron-right-B0WcJHW1.js";import"./aksi-admin-DuslCX0I.js";import"./input-error-CGa-v5px.js";import"./label-C6TNN0Fp.js";import"./select-tOSno9c3.js";import"./index-Di94R_QD.js";import"./chevron-down-DDfTyICo.js";import"./textarea-D-5bDQ0r.js";import"./aksi-kades-C15ZY-rT.js";import"./aksi-kadus-BLB4GbCT.js";import"./form-tanggapan-7-IgdBBv.js";const Ma=()=>{const{auth:l}=B().props;return h.useMemo(()=>{const C=l.user.roles.includes("masyarakat"),d=[{accessorKey:"created_at",id:"Tanggal pengaduan",header:({column:s})=>a.jsxs(e,{variant:"ghost",onClick:()=>s.toggleSorting(s.getIsSorted()==="asc"),children:["Tanggal Pengaduan",a.jsx(o,{className:"ml-2 h-4 w-4"})]}),cell:({row:s})=>{const t=s.original.created_at,r=P(t,"EEEE, d MMMM y",{locale:J});return a.jsx("span",{className:"pl-4 text-center font-medium",children:r})}}];return C||d.push({accessorKey:"user.name",id:"Nama",header:({column:s})=>a.jsxs(e,{variant:"ghost",onClick:()=>s.toggleSorting(s.getIsSorted()==="asc"),children:["Nama",a.jsx(o,{className:"ml-2 h-4 w-4"})]}),cell:({row:s})=>a.jsx("span",{className:"ml-3",children:s.original.user.name})}),d.push({accessorKey:"judul",id:"judul",header:({column:s})=>a.jsxs(e,{variant:"ghost",onClick:()=>s.toggleSorting(s.getIsSorted()==="asc"),children:["Judul",a.jsx(o,{className:"ml-2 h-4 w-4"})]}),cell:({row:s})=>{const t=s.original.judul;return a.jsx("div",{className:"w-[200px] truncate pl-4",children:t})}},{accessorKey:"latest_status.status",id:"status",header:({column:s})=>a.jsxs(e,{variant:"ghost",onClick:()=>s.toggleSorting(s.getIsSorted()==="asc"),children:["Status",a.jsx(o,{className:"ml-2 h-4 w-4"})]}),cell:({row:s})=>{const t=z[s.original.latest_status.status]??"bg-gray-500 text-white";return a.jsx(T,{className:R("ml-3",t),children:s.original.latest_status.status})}},{accessorKey:"latest_status.tindakan",id:"tindakan",header:"Tindakan",cell:({row:s})=>a.jsx("span",{children:s.original.latest_status.tindakan})},{id:"aksi",header:"Aksi",cell:({row:s})=>{const[t,r]=h.useState(!1),[D,c]=h.useState(!1),b=i=>{r(!0),n.delete(route("pengaduan.destroy",{id:i}),{onSuccess:()=>{g.success("Baris berhasil dihapus!"),r(!1),c(!1)},onError:()=>{g.error("Terjadi kesalahan saat menghapus baris."),c(!1),r(!1)}})},S=(i,m)=>{r(!0),n.put(route("pengaduan.validasi.kades",{pengaduan:i,status:m}))},w=(i,m)=>{r(!0),n.put(route("pengaduan.validasi.kades",{pengaduan:i,status:m}))};return a.jsx(a.Fragment,{children:a.jsxs("div",{className:"flex items-center",children:[a.jsx(e,{variant:"ghost",size:"sm",onClick:()=>n.get(route("pengaduan.show",{pengaduan:s.original})),children:a.jsx(I,{className:"h-4 w-4 text-gray-800"})}),v(l.user,["admin"])&&a.jsxs(E,{open:D,onOpenChange:i=>c(i),children:[a.jsx(_,{asChild:!0,children:a.jsx(e,{variant:"ghost",size:"sm",children:a.jsx(F,{className:"h-4 w-4 text-red-500"})})}),a.jsx(K,{className:"sm:max-w-[425px]",children:a.jsxs("div",{className:"flex flex-col items-center justify-center",children:[a.jsx("div",{className:"flex h-14 w-14 items-center justify-center rounded-full bg-red-200",children:a.jsx(Y,{className:"h-8 w-8 text-red-500"})}),a.jsx("h1",{className:"mt-4 text-lg font-bold",children:"Hapus Pengaduan"}),a.jsx("p",{className:"mt-2 text-gray-400",children:"Apakah Anda yakin ingin menghapus ini?"}),a.jsxs("div",{className:"mt-4 grid w-full grid-cols-2 gap-x-2",children:[a.jsx(M,{asChild:!0,children:a.jsx(e,{variant:"outline",children:"Batal"})}),a.jsx(e,{variant:"default",className:"bg-red-500 transition-all duration-300 hover:bg-red-600 active:scale-90",disabled:t,onClick:()=>b(s.original.id),"aria-label":"Delete row",children:"Ya, saya yakin!"})]})]})})]}),s.original.latest_status.status!=="Selesai"&&a.jsx(a.Fragment,{children:v(l.user,["kades"])&&a.jsxs("div",{className:"flex",children:[a.jsxs(u,{children:[a.jsx(p,{asChild:!0,children:a.jsx(e,{variant:"ghost",className:"size-8",children:a.jsx(H,{className:"text-green-500"})})}),a.jsxs(x,{children:[a.jsxs(j,{children:[a.jsx(k,{children:"Apakah Anda yakin ingin memvalidasi pengaduan ini?"}),a.jsx(f,{children:"Aksi ini tidak dapat dibatalkan."})]}),a.jsxs(N,{children:[a.jsx(y,{children:"Batal"}),a.jsx(A,{className:"bg-sky-800",onClick:()=>w(s.original,"Selesai"),children:"Ya, saya yakin!"})]})]})]}),a.jsxs(u,{children:[a.jsx(p,{asChild:!0,children:a.jsx(e,{variant:"ghost",className:"size-8",children:a.jsx(O,{className:"text-red-500"})})}),a.jsxs(x,{children:[a.jsxs(j,{children:[a.jsx(k,{children:"Apakah Anda yakin ingin menolak pengaduan ini?"}),a.jsx(f,{children:"Aksi ini tidak dapat dibatalkan."})]}),a.jsxs(N,{children:[a.jsx(y,{children:"Batal"}),a.jsx(A,{className:"bg-red-500",onClick:()=>S(s.original,"Ditolak Kades"),children:"Ya, saya yakin!"})]})]})]})]})})]})})}}),d},[l.user.roles])};export{Ma as useColumns};
